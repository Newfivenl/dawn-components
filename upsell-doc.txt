documentation

dawn 6.0.2 implementation

snippet file name: nf-cart-drawer-upsell-list.liquid
css: nf-cart-drawer-upsell-list.css


Snippets
1. Put nf-cart-drawer-upsell-list.liquid inside the snippets folder
2. Put nf-cart-drawer-upsell-list.css inside the assets folder
3. Put this code {% render 'nf-cart-drawer-upsell-list' %} to cart-drawer.liquid under <cart-drawer-item>
4. Need to wrap to <div class="drawer__body"></div> to have the scrolling content
  4.1 cart-drawer-items
  4.2 {% render 'nf-cart-drawer-upsell-list %}

5 In cart-drawer.liquid in {%- for item in cart.items -%} line item loop need to put id  data-item="{{ item.product.id }}" to <tr>
 e.g <tr id="CartDrawer-Item-{{ item.index | plus: 1 }}" class="cart-item" role="row" data-item="{{ item.product.id }}">


6 add this code to the very top of cart-drawer.liquid 
{% liquid
  assign first_product_id = ''
  assign cart_items = ''

  for line_item in cart.items
    for tag in line_item.product.tags
      if tag contains 'upsell:'
        assign product_handle = tag | split: ':' | last        
        assign is_in_cart = false

        for line_item in cart.items
          if line_item.product.id == all_products[product_handle].id
            assign is_in_cart = true
          endif
        endfor
        
        unless is_in_cart
          assign cart_upsells_product_handles = cart_upsells_product_handles | append: product_handle | append: ',' 
        endunless
      endif
    endfor
          
    assign cart_items = cart_items | append: line_item.product.id | append: ','
  endfor
%}



7. In cart-drawer.js put this code window.loadNfCartDrawer(true) inside open(triggeredBy) function


8. Replace the cart_drawer in en.default.schema.json
"cart_drawer": {
          "header": "CART DRAWER",
          "collection": {
            "label": "Collection",
            "info": "Visible when cart drawer is empty."
          },
          "cart_upsell_header": {
            "label": "CART UPSELL"
          },
          "text": {
            "label": "Upsell header text"
          },
          "checkbox": {
            "label": "Enable this feature"
          },
          "cart_upsell_tag": {
            "label": "Upsell tag on each upsell",
            "info": "Do not remove [amount] this will be used to replace for upsell price"
          }
        }


9. need to add this to settings_schema.json just below the cart_drawer_collection

{
        "type": "header",
        "content": "t:settings_schema.cart.settings.cart_drawer.cart_upsell_header.label",
        "info": "Works only if cart type is drawer."
      },
      {
        "type": "checkbox",
        "id": "upsell_enable",
        "label": "t:settings_schema.cart.settings.cart_drawer.checkbox.label",
        "default":false
      },
      {
        "type": "text",
        "id": "cart_upsells_title",
        "label": "t:settings_schema.cart.settings.cart_drawer.text.label"
      },
      {
        "type": "textarea",
        "id": "cart_upsell_tag",
        "label": "t:settings_schema.cart.settings.cart_drawer.cart_upsell_tag.label",
        "default": "Love combining? So do we! Add a piece for only [amount]!",
        "info": "t:settings_schema.cart.settings.cart_drawer.cart_upsell_tag.info"
      }


10. need to change cart-drawer.liquid
 remove cart errors

Lastly to enable the Cart Upsell you need to go to Customize > Theme Settings > Cart
click the checkbox and add upseel header text

still need to fix this cart error
e.1 You can only add 1 of this item to your cart.
e.2 There was an error while updating your cart. Please try again.
cart.js triggering this error.
if (this.currentItemCount === itemCount) {}


